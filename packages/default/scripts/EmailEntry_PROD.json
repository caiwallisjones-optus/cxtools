{
 "scriptContent": {
  "header": {
   "scriptName": "DEV\\Digital_Entry_PROD",
   "busNo": 4609725,
   "mediaType": 9,
   "mediaTypeName": "digital",
   "purposeType": "General",
   "variableRedaction": "",
   "nextActionId": 40,
   "status": "Active",
   "lastSavedIn": "stx"
  },
  "actions": {
   "1": {
    "actionId": 1,
    "libraryId": "B2F794C5-0232-40E7-9830-76D573BF57D7",
    "name": "BEGIN",
    "version": 1,
    "label": "Begin",
    "dependencyOrder": "0",
    "implType": "0",
    "x": 64,
    "y": 336,
    "xws": 64,
    "yws": 336
   },
   "2": {
    "actionId": 2,
    "libraryId": "9F9315AA-F999-4269-915B-EE7F9820D97C",
    "name": "GET_EMAIL_DIGITAL",
    "version": 1,
    "label": "GetMessages",
    "dependencyOrder": "1",
    "implType": "0",
    "x": 288,
    "y": 336,
    "xws": 288,
    "yws": 336
   },
   "3": {
    "actionId": 3,
    "libraryId": "7DA9B743-98F4-4899-A5CE-62C9CD414B5B",
    "name": "REQAGENT_DIGITAL",
    "version": 1,
    "label": "Reqagent",
    "dependencyOrder": "5",
    "implType": "0",
    "x": 816,
    "y": 336,
    "xws": 816,
    "yws": 336
   },
   "4": {
    "actionId": 4,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Execute filters",
    "dependencyOrder": "3",
    "implType": "0",
    "x": 368,
    "y": 432,
    "xws": 368,
    "yws": 432
   },
   "8": {
    "actionId": 8,
    "libraryId": "CDDC91CC-F363-4E31-A13A-D742A81A68A3",
    "name": "ONASSIGNMENTCHANGED_DIGITAL",
    "version": 1,
    "label": "OnAssignment",
    "dependencyOrder": "6",
    "implType": "0",
    "x": 64,
    "y": 528,
    "xws": 64,
    "yws": 528
   },
   "9": {
    "actionId": 9,
    "libraryId": "366C8DF6-B598-41F8-8AFC-D9A71F85788A",
    "name": "ONUNASSIGNMENTCHANGED_DIGITAL",
    "version": 1,
    "label": "OnUnassignment",
    "dependencyOrder": "7",
    "implType": "0",
    "x": 64,
    "y": 624,
    "xws": 64,
    "yws": 624
   },
   "12": {
    "actionId": 12,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Define filters",
    "dependencyOrder": "4",
    "implType": "0",
    "x": 368,
    "y": 336,
    "xws": 368,
    "yws": 336
   },
   "13": {
    "actionId": 13,
    "libraryId": "5BF67B1C-9736-434D-9B6F-0D856AEA8F16",
    "name": "WAIT",
    "version": 1,
    "label": "Wait",
    "dependencyOrder": "8",
    "implType": "0",
    "x": 240,
    "y": 528,
    "xws": 240,
    "yws": 528
   },
   "14": {
    "actionId": 14,
    "libraryId": "5BF67B1C-9736-434D-9B6F-0D856AEA8F16",
    "name": "WAIT",
    "version": 1,
    "label": "Wait",
    "dependencyOrder": "9",
    "implType": "0",
    "x": 240,
    "y": 624,
    "xws": 240,
    "yws": 624
   },
   "15": {
    "actionId": 15,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Save to DB",
    "dependencyOrder": "10",
    "implType": "0",
    "x": 976,
    "y": 336,
    "xws": 976,
    "yws": 336
   },
   "24": {
    "actionId": 24,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Set system variables",
    "dependencyOrder": "11",
    "implType": "0",
    "x": 192,
    "y": 336,
    "xws": 192,
    "yws": 336
   },
   "31": {
    "actionId": 31,
    "libraryId": "58437195-DA97-436E-8C3D-7FF126B719D7",
    "name": "REST_API",
    "version": 1,
    "label": "Update CallData",
    "dependencyOrder": "15",
    "implType": "0",
    "x": 800,
    "y": 464,
    "xws": 800,
    "yws": 464
   },
   "32": {
    "actionId": 32,
    "libraryId": "58437195-DA97-436E-8C3D-7FF126B719D7",
    "name": "REST_API",
    "version": 1,
    "label": "Get Token",
    "dependencyOrder": "12",
    "implType": "0",
    "x": 608,
    "y": 336,
    "xws": 608,
    "yws": 336
   },
   "34": {
    "actionId": 34,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Build Tag info",
    "dependencyOrder": "14",
    "implType": "0",
    "x": 704,
    "y": 464,
    "xws": 704,
    "yws": 464
   },
   "35": {
    "actionId": 35,
    "libraryId": "85486BA0-CA00-4FAC-8ED9-00EBF6284B75",
    "name": "FOR",
    "version": 1,
    "label": "For Each Tag",
    "dependencyOrder": "13",
    "implType": "0",
    "x": 704,
    "y": 336,
    "xws": 704,
    "yws": 336
   },
   "36": {
    "actionId": 36,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Define tags",
    "dependencyOrder": "18",
    "implType": "0",
    "x": 480,
    "y": 336,
    "xws": 480,
    "yws": 336
   },
   "37": {
    "actionId": 37,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Execute Tags",
    "dependencyOrder": "17",
    "implType": "0",
    "x": 480,
    "y": 432,
    "xws": 480,
    "yws": 432
   },
   "38": {
    "actionId": 38,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Snippet",
    "dependencyOrder": "16",
    "implType": "0",
    "x": 16,
    "y": 16,
    "xws": 16,
    "yws": 16
   },
   "39": {
    "actionId": 39,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Snippet",
    "dependencyOrder": "2",
    "implType": "0",
    "x": 192,
    "y": 432,
    "xws": 192,
    "yws": 432
   }
  },
  "properties": {
   "1": {
    "0": {
     "name": "RootFolder",
     "value": ""
    },
    "1": {
     "name": "Application",
     "value": ""
    },
    "2": {
     "name": "ParamCount",
     "value": ""
    },
    "3": {
     "name": "Parameters",
     "value": []
    }
   },
   "2": {
    "0": {
     "name": "ContactID",
     "value": "{contactId}"
    },
    "1": {
     "name": "SubjectVar",
     "value": "emailSubject"
    },
    "2": {
     "name": "FromVar",
     "value": "emailFrom"
    },
    "3": {
     "name": "ToVar",
     "value": "emailTo"
    },
    "4": {
     "name": "CCVar",
     "value": "emailCC"
    },
    "5": {
     "name": "DateVar",
     "value": "emailDate"
    },
    "6": {
     "name": "BodyTextVar",
     "value": "emailBody"
    },
    "7": {
     "name": "AttachmentListVar",
     "value": "emailAttachmentListVar"
    },
    "8": {
     "name": "MaxBodyTextLength",
     "value": "Limit32K"
    }
   },
   "3": {
    "0": {
     "name": "Skill",
     "value": "{digitalSkill}"
    },
    "1": {
     "name": "Priority",
     "value": "0"
    },
    "2": {
     "name": "HighProficiency",
     "value": "1"
    },
    "3": {
     "name": "LowProficiency",
     "value": "20"
    }
   },
   "4": {
    "0": {
     "name": "Data",
     "value": "//Define search functions\r\nFUNCTION EmailContains(phraseList)\r\n{\r\n  \tglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] DEBUG Searching for phrase\"\r\n\tFOREACH phrase IN phraseList\r\n  \t{\r\n    \tIF global:emailSubject.lower().contains(phrase)\r\n    \t{\r\n      \t\tglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] DEBUG found phrase in subject - {phrase}\"\r\n\t\t\tRETURN true\r\n    \t}\r\n    }\r\n\tFOREACH line IN global:emailBody\r\n    {\r\n      \tFOREACH phrase IN phraseList\r\n  \t\t{\r\n\t\t\tIF line.lower().contains(phrase)\r\n      \t\t{\r\n        \t\tglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] DEBUG found phrase in body - {phrase}\"\r\n\t\t\t\tRETURN true\r\n      \t\t}\r\n  \t\t}\r\n\t}\r\n  \tRETURN false\r\n}\r\n\r\nglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] Started filter matching\"\r\n\r\ndigitalFilterMatch=false\r\n\r\nFOR i = 1 TO digitalfilters.count()\r\n{\r\n  filterLine = digitalfilters[i].split(char(9))\r\n  filterSkill=filterLine[1]\r\n  filterType=filterLine[2].upper()\r\n  filterParams=filterLine[3].lower().split(\",\")\r\n\r\n  global:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] Testing filter - {filterLine}\"\r\n  //Only supports OR criteria\r\n  SWITCH filterType\r\n  {\r\n    CASE \"EMAILTO\"\r\n    {\r\n       \tFOREACH emailToAddress IN emailTo.toVar\r\n\t\t{\tIF filterParams.indexof(\"{emailToAddress}\") > 0\r\n\t\t\t{\tglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] Match to - {emailToAddress}\"\r\n\t\t\t\tdigitalFilterMatch=true\t\t\t}\r\n\t\t}\r\n\t\tFOREACH emailCCAddress IN emailCC.ccvar\r\n\t\t{\tIF filterParams.indexof(\"{emailCCAddress}\") > 0\r\n\t\t\t{\tglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] Match cc - {emailCCAddress}\"\t\r\n\t\t\t\tdigitalFilterMatch=true\t\t\t}\r\n\t\t}\r\n    }\r\n\tCASE \"EMAILFROM\"\r\n    {\r\n      IF filterParams.indexof(\"{emailFrom}\") > 0\r\n      {\r\n        global:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] Match from - {fromVar}\"\t\r\n\t\tdigitalFilterMatch=true\r\n      }\r\n    }\r\n    CASE \"CONTAINS\" \r\n\t{ \r\n\t\tdigitalFilterMatch=EmailContains(filterParams)\r\n\t}\r\n  }\r\n  \r\n  IF digitalFilterMatch\r\n  {\t\r\n  \tdigitalSkill = filterSkill\r\n\tglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] filter matched - {digitalfilters[i]}\"\r\n  \tBREAK\r\n  }\r\n}"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "8": {
    "0": {
     "name": "SkillID",
     "value": "SKLID"
    },
    "1": {
     "name": "SkillName",
     "value": "SKLNAME"
    },
    "2": {
     "name": "AgentFirstName",
     "value": "FIRST"
    },
    "3": {
     "name": "AgentLastName",
     "value": "LAST"
    },
    "4": {
     "name": "UserID",
     "value": "USERID"
    },
    "5": {
     "name": "AgentID",
     "value": "AGENTID"
    },
    "6": {
     "name": "PriorAgentFirstName",
     "value": "PRIORFIRST"
    },
    "7": {
     "name": "PriorAgentLastName",
     "value": "PRIORLAST"
    },
    "8": {
     "name": "PriorUserID",
     "value": "PRIORUSERID"
    },
    "9": {
     "name": "PriorAgentID",
     "value": "PRIORAGENTID"
    },
    "10": {
     "name": "IsTransfer",
     "value": "ISTRANSFER"
    }
   },
   "9": {
    "0": {
     "name": "SkillID",
     "value": "SKLID"
    },
    "1": {
     "name": "SkillName",
     "value": "SKLNAME"
    },
    "2": {
     "name": "PriorAgentFirstName",
     "value": "PRIORFIRST"
    },
    "3": {
     "name": "PriorAgentLastName",
     "value": "PRIORLAST"
    },
    "4": {
     "name": "PriorUserID",
     "value": "PRIORUSERID"
    },
    "5": {
     "name": "PriorAgentID",
     "value": "PRIORAGENTID"
    }
   },
   "12": {
    "0": {
     "name": "Data",
     "value": "global:pressPath[1+global:pressPath.count] = \"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] Building digital parameters\" \r\n//Digital skills list:\r\n//\"23055600\" //Property Tax\"\t\r\n//\"23055601\" //Change Of Address\"\r\n//\"23055602\" //REV Support\"\r\n//\"23055603\" //Account Locked\"\r\n//\"23145695\" //Support\"\r\n//\"23145696\" //Leaders\"\t\r\n//\"23145697\" //RUC\"\r\n//Defined rules:\r\n//Property Tax- Emails with a 'to;landTax@sa.gov.au\" or\"landtaxenquiries@sa.gov.au\" or\"revsaesl@sa.gov.au\" or\"eslinstalments@sa.gov.au\"\r\n//Change of Address-. Emails with a\"to;RevSAChangeAddress@sa.gov.au \" or \"No longer at this address\" or\"\"I have moved\" or \"no longer managed\"\r\n//Rev support - Emails with a \"to;revsupport@sa.gov.au\"\r\n//Account Lock- Emails with a TO;\"LandTaxForms@sa.gov.au \" or TO;RSAESLConcessionApplications@sa.gov.au \" or \"I no longer meet my exemption criteria\"\r\n//Support - Emails that include;\"Ombudsman\", \"Escalation\" from any mailbox\r\n//Leaders- Emails that include: complaint\r\n//RUC - Emails that include: undeliverable\r\n\r\n\r\ndigitalSkill = \"23145699\" //General Emails\"\t- fallback/default\r\n\r\ndigitalfilters[1+digitalfilters.count] = \"23055600\tEMAILTO\tlandTax@sa.gov.au,landtaxenquiries@sa.gov.au,revsaesl@sa.gov.au,eslinstalments@sa.gov.au\"\r\ndigitalfilters[1+digitalfilters.count] = \"23055601\tEMAILTO\tRevSAChangeAddress@sa.gov.au\"\r\ndigitalfilters[1+digitalfilters.count] = \"23055601\tCONTAINS\tNo longer at this address,I have moved,no longer managed\"\r\ndigitalfilters[1+digitalfilters.count] = \"23055602\tEMAILTO\trevsupport@sa.gov.au\"\r\ndigitalfilters[1+digitalfilters.count] = \"23055603\tEMAILTO\tLandTaxForms@sa.gov.au,RSAESLConcessionApplications@sa.gov.au\"\r\ndigitalfilters[1+digitalfilters.count] = \"23055603\tCONTAINS\tI no longer meet my exemption criteria\"\t\r\ndigitalfilters[1+digitalfilters.count] = \"23145695\tCONTAINS\tOmbudsman,Escalation\"\r\ndigitalfilters[1+digitalfilters.count] = \"23145696\tCONTAINS\tcomplaint\"\r\ndigitalfilters[1+digitalfilters.count] = \"23145697\tCONTAINS\tundeliverable\"\r\n\r\nglobal:pressPath[1+global:pressPath.count] = \"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] Digital Filter conditions {digitalfilters.count}\" \r\n\r\n"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "13": {
    "0": {
     "name": "Seconds",
     "value": "5"
    }
   },
   "14": {
    "0": {
     "name": "Seconds",
     "value": "5"
    }
   },
   "15": {
    "0": {
     "name": "Data",
     "value": "global:pressPath.savetodb(1)"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "24": {
    "0": {
     "name": "Data",
     "value": "DYNAMIC contactDetails FROM __MESSAGE\r\n\r\nASSIGN headers = \"{char(123)} 'Content-Type': 'application/json' {char(125)}\"\r\nASSIGN params = \"{char(123)} 'accessKeyId': 'DCY3YIVL3TP3U5LLCUMQ5OOVNK6GERTBFV5YHXE7LROUWDMWHZGA====', 'accessKeySecret': 'SPZVXFAG3HRUFHRQYNX6UXFPPWRWUEUTHRZ24VSQE2SEHX5MBZ7Q====' {char(125)}\""
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "31": {
    "0": {
     "name": "Command",
     "value": "MakeRestRequest"
    },
    "1": {
     "name": "ServiceAddress",
     "value": "{endpoint}"
    },
    "2": {
     "name": "Headers",
     "value": "{headers}"
    },
    "3": {
     "name": "Parameters",
     "value": "{params}"
    },
    "4": {
     "name": "Verb",
     "value": "PUT"
    },
    "5": {
     "name": "TimeOutInMilliSeconds",
     "value": "30000"
    },
    "6": {
     "name": "resultSet",
     "value": "resultSet2"
    },
    "7": {
     "name": "errorArgList",
     "value": "errorArgList2"
    },
    "8": {
     "name": "responseHeaders",
     "value": "responseHeaders2"
    }
   },
   "32": {
    "0": {
     "name": "Command",
     "value": "MakeRestRequest"
    },
    "1": {
     "name": "ServiceAddress",
     "value": "https://au1.nice-incontact.com/authentication/v1/token/access-key"
    },
    "2": {
     "name": "Headers",
     "value": "{headers}"
    },
    "3": {
     "name": "Parameters",
     "value": "{params}"
    },
    "4": {
     "name": "Verb",
     "value": "POST"
    },
    "5": {
     "name": "TimeOutInMilliSeconds",
     "value": "30000"
    },
    "6": {
     "name": "resultSet",
     "value": "resultSet"
    },
    "7": {
     "name": "errorArgList",
     "value": "errorArgList"
    },
    "8": {
     "name": "responseHeaders",
     "value": "responseHeaders"
    }
   },
   "34": {
    "0": {
     "name": "Data",
     "value": "ASSIGN token = \"{resultset.access_token}\"\r\n\r\nASSIGN endpoint = \"https://api-au1.niceincontact.com/dfo/3.0/messages/{contactdetails.id}/tags/{tags[index]}\"\r\nASSIGN headers = $'\\{ \"Content-Type\": \"application/json\", \"Authorization\" : \"Bearer {token}\"}'\r\nASSIGN params = $''\r\n\r\n"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "35": {
    "0": {
     "name": "FromValue",
     "value": "1"
    },
    "1": {
     "name": "ToValue",
     "value": "tags.count()"
    },
    "2": {
     "name": "Step",
     "value": "1"
    },
    "3": {
     "name": "CounterName",
     "value": "INDEX"
    }
   },
   "36": {
    "0": {
     "name": "Data",
     "value": "taglist = \"\"\r\n\r\n//Define tag filters\r\n//<TAG ONLY FOR THIS SKILL>,<tag name>,<condition>\r\n//\"23055600\" //Property Tax\r\ndigitalTags[1+digitalTags.count] = \"23055600\tesl\tEMAILTO\trevsaesl@sa.gov.au\"\r\ndigitalTags[1+digitalTags.count] = \"23055600\tet\tEMAILTO\tlandtaxenquiries@sa.gov.au,l﻿andTax@sa.gov.au\"\r\ndigitalTags[1+digitalTags.count] = \"23055600\textensions\tCONTAINS\textension,longer to pay\"\r\ndigitalTags[1+digitalTags.count] = \"23055600\tbalance\tCONTAINS\thow much is left to pay,outstanding amount\"\r\ndigitalTags[1+digitalTags.count] = \"23055600\ttable\tCONTAINS\ttable of payments\"\r\ndigitalTags[1+digitalTags.count] = \"23055600\treprint\tCONTAINS\tcopy of bill,missing assessment,copy of reprint\"\r\ndigitalTags[1+digitalTags.count] = \"23055600\tremittance\tCONTAINS\tremittance advice\"\r\ndigitalTags[1+digitalTags.count] = \"23055600\tinstallments\tCONTAINS\tinstallment request ESL,Installments,Installment\"\r\ndigitalTags[1+digitalTags.count] = \"23055600\tsales advice\tCONTAINS\tchange of ownership\"\r\n//\"23055601\" //Change Of Address\"\r\ndigitalTags[1+digitalTags.count] = \"23055601\tmanaging agent\tCONTAINS\tManaging Agent Registration,n﻿o longer managed\"\r\ndigitalTags[1+digitalTags.count] = \"23055601\tCOA\tCONTAINS\tN﻿o longer at this address,I ﻿have moved\"\r\ndigitalTags[1+digitalTags.count] = \"23055601\tRUC\tCONTAINS\t*To add different subject lines of email billing*\"\r\n//\"23055602\" //REV Support\"\r\ndigitalTags[1+digitalTags.count] = \"23055602\tNew Users\tCONTAINS\tRSAOL Change Administrator (Iapply),Add user,Access to system\"\r\ndigitalTags[1+digitalTags.count] = \"23055602\tBank Account\tCONTAINS\tRSAOL Direct Debit Request(Iapply),Add bank account\"\r\ndigitalTags[1+digitalTags.count] = \"23055602\tCycle Change\tCONTAINS\tReturn Frequency,lodgement Change\"\r\ndigitalTags[1+digitalTags.count] = \"23055602\tRSAOL Applications\tCONTAINS\tRSAOL Registration,Approved Person (Iapply)\"\r\ndigitalTags[1+digitalTags.count] = \"23055602\tData Entry\tCONTAINS\tManual data entry,Application for Stamp Duty Assessment\"\r\ndigitalTags[1+digitalTags.count] = \"23055602\tPRT Cancellation\tCONTAINS\tPayroll Tax,Request to cancel registration (Iapply)\"\r\n//\"23055603\" //Account Locked\"\r\ndigitalTags[1+digitalTags.count] = \"23055603\tConcession Apps\tCONTAINS\tEmergency Services Levy (Fixed Property)\"\r\ndigitalTags[1+digitalTags.count] = \"23055603\tPPR Apps\tCONTAINS\tExemption Application: O/N\"\r\ndigitalTags[1+digitalTags.count] = \"23055603\tNot my PPR\tCONTAINS\tI no longer meet my exemption criteria\"\r\n//\"23145695\" //Support\"\r\ndigitalTags[1+digitalTags.count] = \"23145695\tOmbudsman\tCONTAINS\tOmbudsman\"\r\ndigitalTags[1+digitalTags.count] = \"23145695\tEscalation\tCONTAINS\tUrgent,Member of Parliament,Ministers Office,Haven't heard\"\r\n//\"23145696\" //Leaders\"\t\r\ndigitalTags[1+digitalTags.count] = \"23145696\tComplaint\tCONTAINS\tComplain,Complaint,Disgusted,Annoyed,Management\"\r\n\r\n//\"23145697\" //RUC\"\r\n//TODO\r\n\r\ndigitalTags[1+digitalTags.count] = \"*\tComplaint\tCONTAINS\tComplain,Complaint,Disgusted,Annoyed,Management\"\r\n\r\n\r\n"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "37": {
    "0": {
     "name": "Data",
     "value": "//Tag calls based on tag filters\r\nFUNCTION TagIdFromName(name)\r\n{\r\n\t//Rebuild tag list by extracting from API, convert to a table and then use excel to build new list - \r\n\t//https://developer.niceincontact.com/API/DigitalEngagementAPI#/Tag\r\n\t//https://webutility.io/json-to-table\r\n\t//=\"CASE \"\"\" & LOWER(A2) & \"\"\"\" & \"  { RETURN \" & B2 & \"}\"\r\n\tSWITCH name\r\n\t{\r\n\t\tCASE \"balance\"  { RETURN 5184}\r\n\t\tCASE \"bank account\"  { RETURN 5244}\r\n\t\tCASE \"coa\"  { RETURN 5241}\r\n\t\tCASE \"concession apps\"  { RETURN 5249}\r\n\t\tCASE \"cycle change\"  { RETURN 5245}\r\n\t\tCASE \"data entry\"  { RETURN 5247}\r\n\t\tCASE \"escalation\"  { RETURN 5253}\r\n\t\tCASE \"esl\"  { RETURN 5234}\r\n\t\tCASE \"extensions\"  { RETURN 5182}\r\n\t\tCASE \"installments\"  { RETURN 5238}\r\n\t\tCASE \"lt\"  { RETURN 5183}\r\n\t\tCASE \"managing agent\"  { RETURN 5240}\r\n\t\tCASE \"new users\"  { RETURN 5243}\r\n\t\tCASE \"not my ppr\"  { RETURN 5251}\r\n\t\tCASE \"ombudsman\"  { RETURN 5252}\r\n\t\tCASE \"p and i remission\"  { RETURN 5235}\r\n\t\tCASE \"ppr apps\"  { RETURN 5250}\r\n\t\tCASE \"prt cancellation\"  { RETURN 5248}\r\n\t\tCASE \"remittance advice\"  { RETURN 5237}\r\n\t\tCASE \"reprint\"  { RETURN 5236}\r\n\t\tCASE \"rsaol\"  { RETURN 5246}\r\n\t\tCASE \"ruc\"  { RETURN 5242}\r\n\t\tCASE \"sales advice\"  { RETURN 5239}\r\n\t\tCASE \"table\"  { RETURN 5181}\r\n\t}\r\n\t\r\n\tRETURN \"0000\"\r\n}\r\n\r\nglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] Started tag matching\"\r\n\r\nFOR i = 1 TO digitalTags.count\r\n{\r\n  tagLine = digitalTags[i].split(char(9))\r\n  filterSkill=tagLine[1]\r\n  filtertagName=tagLine[2].lower()\r\n  filterType=tagLine[3].upper()\r\n  filterParams=filterLine[3].lower().split(\",\")\r\n  //Only add tags if we have the correct skill\r\n  IF (filterSkill = digitalSkill) || (filterSkill = \"*\")\r\n  {\r\n  \ttagFilterMatch = false\r\n\t//Check the criteria\r\n\tglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] DEBUG - Checking skill tags for skill {filterSkill}\"\r\n\tSWITCH filterType\r\n  \t{\r\n//    \tCASE \"EMAILTO\"\r\n//    \t{\r\n//      \t\tIF EMailToInList(filterParams.split(\",\"))\r\n//      \t\t{\r\n//        \tdigitalSkill=digitalSkill[i]\r\n//        \ttagFilterMatch=true\r\n//      \t\t}\r\n//    \t}\r\n//\t\tCASE \"EMAILFROM\"\r\n//    \t{\r\n//      \t\tIF EMailFromInList(filterParams.split(\",\"))\r\n//      \t\t{\r\n//        \tdigitalSkill=digitalSkill[i]\r\n//        \ttagFilterMatch=true\r\n//      \t\t}\r\n//    \t}\r\n    \tCASE \"CONTAINS\" \r\n\t\t{ \r\n\t\t\tglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] CONTAINS CHECK {filterParams}\"\r\n\t\t\ttagFilterMatch=EmailContains(filterParams)\r\n\t\t}\r\n  \t}\r\n\t\r\n\tIF tagFilterMatch\r\n\t{\r\n\t\ttags[1+tags.count] = TagIdFromName(filtertagName)\r\n\t\tglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] TAG MATCHED - {digitalTags[i]}\"\r\n\t\t\r\n\t}\r\n  }\r\n}\r\n"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "38": {
    "0": {
     "name": "Data",
     "value": "DYNAMIC global:toVar\r\nDYNAMIC hello = \"HELLO\"\r\nDYNAMIC world = \"WORLD\"\r\nglobal:toVar.toVar[1]=\"hello\"\r\nglobal:toVar.toVar[2]=\"world\"\r\nFUNCTION mytest(listCount)\r\n{\r\n\tFOR i = 1 TO listCount\r\n\t{\r\n\t}\r\n}\r\n\r\n\r\n\r\nmytest(global:toVar.toVar.count())\r\ntest2=global:toVar.toVar[1].$value\r\nFOR i = 1 TO 10\r\n{\r\n}\r\n"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "39": {
    "0": {
     "name": "Data",
     "value": "DYNAMIC test\r\ntest.test[1] = \"hello_1\"\r\ntest.test[2] = \"world_1\"\r\n\r\nFOREACH info IN test.test\r\n{\r\n\tglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] {info} \"\r\n}\r\n\r\nDYNAMIC global:test2\r\nglobal:test2.test[1] = \"hello\"\r\nglobal:test2.test[2] = \"world\"\r\n\r\n\r\nFOREACH info IN global:test2.test\r\n{\r\n\tglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] {info} \"\r\n}\r\n\r\n\r\n\r\n//FUNCTION TESTME()\r\n//{\r\n//\tFOREACH info IN global:test2.test\r\n//\t{\t\r\n//\t\tglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] {info} \"\r\n//\t}\r\n//}\r\n//\r\n//TESTME()\r\n\r\n FUNCTION testme2(int_test)\r\n {\r\n \tglobal:debug = int_test\r\n\tFOREACH info IN int_test\r\n\t{\r\n\t\tglobal:pressPath[1+global:pressPath.count]=\"{now.datefmt(\"yyyy_mm_dd hh:mm:ss\")} [DIGITAL] {info} \"\r\n\t}\r\n }\r\n \r\n\r\ntestme2(test.test)\r\n\r\n "
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   }
  },
  "branches": {
   "1": [
    {
     "to": 24,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "2": [
    {
     "to": 12,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "3": [
    {
     "to": 15,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "4": [
    {
     "to": 37,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "8": [
    {
     "to": 13,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "9": [
    {
     "to": 14,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "12": [
    {
     "to": 36,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "24": [
    {
     "to": 2,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "31": [
    {
     "to": 35,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "32": [
    {
     "to": 35,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "34": [
    {
     "to": 31,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "35": [
    {
     "to": 3,
     "label": "Finished",
     "type": "branch",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    },
    {
     "to": 34,
     "label": "Repeat",
     "type": "branch",
     "labelDistance": null,
     "index": 1,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "36": [
    {
     "to": 4,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "37": [
    {
     "to": 32,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "39": [
    {
     "to": 13,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ]
  },
  "schemaVersion": "1.0.0"
 }
}