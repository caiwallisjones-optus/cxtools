{
 "scriptContent": {
  "header": {
   "scriptName": "Menu_PROD",
   "busNo": 4609748,
   "mediaType": 4,
   "mediaTypeName": "call",
   "purposeType": "General",
   "variableRedaction": "",
   "nextActionId": 199,
   "status": "Active",
   "lastSavedIn": "stx"
  },
  "actions": {
   "73": {
    "actionId": 73,
    "libraryId": "93232E99-D607-4E7D-9300-17986D70DA3C",
    "name": "RUNSCRIPT",
    "version": 1,
    "label": "{nextScript}",
    "dependencyOrder": "0",
    "implType": "0",
    "x": 1360,
    "y": 736,
    "xws": 1360,
    "yws": 736
   },
   "145": {
    "actionId": 145,
    "libraryId": "5BF67B1C-9736-434D-9B6F-0D856AEA8F16",
    "name": "WAIT",
    "version": 1,
    "label": "Wait",
    "dependencyOrder": "1",
    "implType": "0",
    "x": 256,
    "y": 288,
    "xws": 256,
    "yws": 288
   },
   "158": {
    "actionId": 158,
    "libraryId": "B2F794C5-0232-40E7-9830-76D573BF57D7",
    "name": "BEGIN",
    "version": 1,
    "label": "Menu",
    "dependencyOrder": "2",
    "implType": "0",
    "x": 32,
    "y": 288,
    "xws": 32,
    "yws": 288
   },
   "167": {
    "actionId": 167,
    "libraryId": "F8B958D0-8CD3-40DF-97D3-5862930B0807",
    "name": "RUNSUB",
    "version": 1,
    "label": "Reskill",
    "dependencyOrder": "3",
    "implType": "0",
    "x": 1184,
    "y": 736,
    "xws": 1184,
    "yws": 736
   },
   "168": {
    "actionId": 168,
    "libraryId": "D28D2B39-D4DB-499A-9B8B-F3879E4C5B25",
    "name": "ANNOTATION",
    "version": 1,
    "label": "Annotation",
    "dependencyOrder": "4",
    "implType": "0",
    "x": 16,
    "y": 16,
    "xws": 16,
    "yws": 16
   },
   "171": {
    "actionId": 171,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Set Queue as default next script",
    "dependencyOrder": "6",
    "implType": "0",
    "x": 144,
    "y": 288,
    "xws": 144,
    "yws": 288
   },
   "173": {
    "actionId": 173,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Ini Menu Variables",
    "dependencyOrder": "8",
    "implType": "0",
    "x": 480,
    "y": 288,
    "xws": 480,
    "yws": 288
   },
   "174": {
    "actionId": 174,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Parse Next Step",
    "dependencyOrder": "9",
    "implType": "0",
    "x": 624,
    "y": 288,
    "xws": 624,
    "yws": 288
   },
   "175": {
    "actionId": 175,
    "libraryId": "F8B958D0-8CD3-40DF-97D3-5862930B0807",
    "name": "RUNSUB",
    "version": 1,
    "label": "Execute Common Action",
    "dependencyOrder": "10",
    "implType": "0",
    "x": 752,
    "y": 480,
    "xws": 752,
    "yws": 480
   },
   "177": {
    "actionId": 177,
    "libraryId": "B1B9A2DD-65B6-4626-9CF5-9CFA69CF59E2",
    "name": "PLAY",
    "version": 1,
    "label": "Cannot find response to step",
    "dependencyOrder": "11",
    "implType": "0",
    "x": 624,
    "y": 736,
    "xws": 624,
    "yws": 736
   },
   "179": {
    "actionId": 179,
    "libraryId": "6695BA9C-E1D6-4F3C-A15A-94F1400E3169",
    "name": "IF",
    "version": 1,
    "label": "If no step found with name",
    "dependencyOrder": "12",
    "implType": "0",
    "x": 752,
    "y": 288,
    "xws": 752,
    "yws": 288
   },
   "180": {
    "actionId": 180,
    "libraryId": "B1B9A2DD-65B6-4626-9CF5-9CFA69CF59E2",
    "name": "PLAY",
    "version": 1,
    "label": "Cannot find name of step",
    "dependencyOrder": "13",
    "implType": "0",
    "x": 1184,
    "y": 288,
    "xws": 1184,
    "yws": 288
   },
   "182": {
    "actionId": 182,
    "libraryId": "22050500-6DC0-4949-AF9C-1E52975F141D",
    "name": "CASE",
    "version": 1,
    "label": "If Action Completes Menu",
    "dependencyOrder": "14",
    "implType": "0",
    "x": 976,
    "y": 480,
    "xws": 976,
    "yws": 480
   },
   "186": {
    "actionId": 186,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Dynamic Variable Functions",
    "dependencyOrder": "7",
    "implType": "0",
    "x": 736,
    "y": 16,
    "xws": 736,
    "yws": 16
   },
   "187": {
    "actionId": 187,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Determine Next Step Name",
    "dependencyOrder": "15",
    "implType": "0",
    "x": 976,
    "y": 624,
    "xws": 976,
    "yws": 624
   },
   "188": {
    "actionId": 188,
    "libraryId": "F8B958D0-8CD3-40DF-97D3-5862930B0807",
    "name": "RUNSUB",
    "version": 1,
    "label": "OnMenu",
    "dependencyOrder": "16",
    "implType": "0",
    "x": 368,
    "y": 288,
    "xws": 368,
    "yws": 288
   },
   "192": {
    "actionId": 192,
    "libraryId": "6695BA9C-E1D6-4F3C-A15A-94F1400E3169",
    "name": "IF",
    "version": 1,
    "label": "Found Next Action Name",
    "dependencyOrder": "17",
    "implType": "0",
    "x": 624,
    "y": 624,
    "xws": 624,
    "yws": 624
   },
   "193": {
    "actionId": 193,
    "libraryId": "F8B958D0-8CD3-40DF-97D3-5862930B0807",
    "name": "RUNSUB",
    "version": 1,
    "label": "Event CustomQueueEvent",
    "dependencyOrder": "18",
    "implType": "0",
    "x": 976,
    "y": 384,
    "xws": 976,
    "yws": 384
   },
   "194": {
    "actionId": 194,
    "libraryId": "22050500-6DC0-4949-AF9C-1E52975F141D",
    "name": "CASE",
    "version": 1,
    "label": "CustomEvent",
    "dependencyOrder": "19",
    "implType": "0",
    "x": 752,
    "y": 384,
    "xws": 752,
    "yws": 384
   },
   "196": {
    "actionId": 196,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Common Functions",
    "dependencyOrder": "5",
    "implType": "0",
    "x": 640,
    "y": 16,
    "xws": 640,
    "yws": 16
   },
   "197": {
    "actionId": 197,
    "libraryId": "EA1363D4-FADE-4CAC-B15E-C4C514C2F9B5",
    "name": "ONRELEASE",
    "version": 1,
    "label": "Onrelease",
    "dependencyOrder": "20",
    "implType": "0",
    "x": 32,
    "y": 944,
    "xws": 32,
    "yws": 944
   },
   "198": {
    "actionId": 198,
    "libraryId": "B333DA63-33C8-4297-A58A-E9546CF7F0F2",
    "name": "SNIPPET",
    "version": 1,
    "label": "Debug (ON RELEASE)",
    "dependencyOrder": "21",
    "implType": "0",
    "x": 160,
    "y": 944,
    "xws": 160,
    "yws": 944
   }
  },
  "properties": {
   "73": {
    "0": {
     "name": "ScriptName",
     "value": "{scriptPath}{nextScript}"
    }
   },
   "145": {
    "0": {
     "name": "Seconds",
     "value": ".5"
    }
   },
   "158": {
    "0": {
     "name": "RootFolder",
     "value": ""
    },
    "1": {
     "name": "Application",
     "value": ""
    },
    "2": {
     "name": "ParamCount",
     "value": ""
    },
    "3": {
     "name": "Parameters",
     "value": []
    }
   },
   "167": {
    "0": {
     "name": "ScriptName",
     "value": "{customEventsScript}"
    },
    "1": {
     "name": "ParamCount",
     "value": ""
    },
    "2": {
     "name": "ReturnVariable",
     "value": "rtn"
    },
    "3": {
     "name": "Parameters",
     "value": [
      "OnReskill",
      "",
      ""
     ]
    }
   },
   "168": {
    "0": {
     "name": "Comments",
     "value": "Moving to a standard Menu structure\n\n24_12_01 \nRemoved Menu Sub to allow custom actions to work properly in this script, this will alsoo allow us to run \nmenus as a NEXTSCRIPT action e.g NEXTSCRIPT,Menu_{env},1001 will execute menu associated with 1001 \nentry point/route point"
    },
    "1": {
     "name": "Width",
     "value": "592"
    },
    "2": {
     "name": "Height",
     "value": "215"
    }
   },
   "171": {
    "0": {
     "name": "Data",
     "value": "global:nextScript = \"Queue_{global:ENV}\"\r\n\r\nDebugLog(\"DEBUG\",\"Set next script to {global:nextScript}\")"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "173": {
    "0": {
     "name": "Data",
     "value": "DYNAMIC menu\r\nmenu.StepName = ItemFromList(menuActions[1],\",\",1)\r\n\r\nDebugLog(\"DEBUG\", \"Starting first step {menu.StepName.$value}\")"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "174": {
    "0": {
     "name": "Data",
     "value": "IF Test\r\n{\r\n  DYNAMIC menu\r\n  menu.StepName=\"BEGIN\"\r\n  ASSIGN menuActions[1]=\"BEGIN,CHECKHOURS,418\"\r\n  ASSIGN menuActions[2]=\"HooHoliday,HANGUP,Holiday.wav\"\r\n  ASSIGN menuActions[3]=\"HooClosed,HANGUP,Closed.wav\"\r\n  ASSIGN menuActions[4]=\"PlayWelcome,PLAY,Welcome.wav\"\r\n  ASSIGN menuActions[5]=\"QueueToSkill,QUEUE,12345\"\r\n}\r\n\r\nFUNCTION GetParams(line)\r\n{\r\n\tlineArray = line.split(',')\r\n\tIF (lineArray.count > 3)\r\n    {\r\n        FOR j = 4 TO lineArray.count()\r\n        {\r\n          params[j-3]=lineArray[j]\r\n        }\r\n    }\r\n\tRETURN params\r\n}\r\n\r\nFUNCTION IsAction(line,firstItem)\r\n{\r\n\titems=line.split(',')\r\n\tIF \"{items[1].upper()}\" = \"{firstItem.upper()}\")\r\n\t{\tRETURN true\r\n\t}\r\n\tELSE\r\n\t{\tRETURN false\r\n\t}\r\n}\t\r\n\r\nFOR i = 1 TO global:menuActions.count()\r\n{\r\n    \r\n    IF IsAction(menuActions[i],menu.StepName.$value)\r\n    {\r\n      //We found a step to action\r\n      menu.StepAction=ItemFromList(menuActions[i],\",\",2)\r\n      menu.StepPrompt=ItemFromList(menuActions[i],\",\",3)\r\n      menu.StepParams=GetParams(menuActions[i])\r\n\t  DebugLog(\"DEBUG\",\"Starting step actions for  step {menu.StepName.$value} ({menuActions[i]}) \")\r\n      BREAK\r\n    }\r\n}\r\n"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "175": {
    "0": {
     "name": "ScriptName",
     "value": "Common\\CommonAction"
    },
    "1": {
     "name": "ParamCount",
     "value": ""
    },
    "2": {
     "name": "ReturnVariable",
     "value": "rtn"
    },
    "3": {
     "name": "Parameters",
     "value": [
      "{menu.StepAction.$value}",
      "{menu.StepParams.$value}",
      "{menu.StepPrompt.$value}"
     ]
    }
   },
   "177": {
    "0": {
     "name": "Sequence",
     "value": "\"%Error in I.V.R. Steps - action response not found please contact technical services\""
    },
    "1": {
     "name": "Phrase",
     "value": ""
    },
    "2": {
     "name": "ClearDigits",
     "value": "True"
    },
    "3": {
     "name": "DetectDTMF",
     "value": "True"
    },
    "4": {
     "name": "SuppressSilence",
     "value": ""
    },
    "5": {
     "name": "TTSVolume",
     "value": ""
    },
    "6": {
     "name": "TTSRate",
     "value": ""
    },
    "7": {
     "name": "TTSVoice",
     "value": ""
    }
   },
   "179": {
    "0": {
     "name": "Expression",
     "value": "menu.StepAction.$value.length > 1"
    }
   },
   "180": {
    "0": {
     "name": "Sequence",
     "value": "\"%Error in I.V.R Steps - please contact technical services\""
    },
    "1": {
     "name": "Phrase",
     "value": ""
    },
    "2": {
     "name": "ClearDigits",
     "value": "True"
    },
    "3": {
     "name": "DetectDTMF",
     "value": "True"
    },
    "4": {
     "name": "SuppressSilence",
     "value": ""
    },
    "5": {
     "name": "TTSVolume",
     "value": ""
    },
    "6": {
     "name": "TTSRate",
     "value": ""
    },
    "7": {
     "name": "TTSVoice",
     "value": ""
    }
   },
   "182": {
    "0": {
     "name": "Variable",
     "value": "menu.StepAction.$value"
    }
   },
   "186": {
    "0": {
     "name": "Data",
     "value": "IF test\n{\n\tDYNAMIC menu\n}\n\nFUNCTION DynamicItemFromList(list,index)\n{\n\tRETURN list[index]\n}\n\nFUNCTION ItemFromList(list,delimiter,index)\n{\n\ttemp = list.split(delimiter)\n\tRETURN temp[index]\n}"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "187": {
    "0": {
     "name": "Data",
     "value": "//Based on user response see what we need to do\r\nIF test \r\n{\t\r\nDYNAMIC global:menu\r\n}\r\n\r\nFUNCTION FindNextStep(stepName,stepAction,setRespone)\r\n{\r\n\tASSIGN menuNextStepName = \"NO_ACTION_FOUND\"\t\r\n\tASSIGN menuDefaultStepName = \"NO_ACTION_FOUND\"\r\n\tDebugLog(\"DEBUG\",\"Finding next step for name:{stepName}  action:{stepAction}, response:{setRespone}\")\r\n\tFOR i = 1 TO global:menuResponses.count()\r\n\t{\r\n\t\t\r\n\t\tresponse = global:menuResponses[i].split(\",\")\r\n\t\t//Check if it was a response for this action\r\n    \tIF response[1].upper() = \"{stepName.upper()}\"\r\n\t\t{\r\n\t\t\t//DebugLog(\"DEBUG - found action in response [{i}])\")\r\n\t\t\t//Check for the fallback option, and set this as the default next step\r\n\t\t\tIF \"{response[2].upper()}\" = \"DEFAULT\"\r\n\t\t\t{\r\n\t\t\t\t//Update the action but keep checking......\r\n\t\t\t\tDebugLog(\"DEBUG\",\"    found default response -({response[3]})\")\r\n\t\t\t\tmenuDefaultStepName = response[3]\r\n\t\t\t}\r\n\t\t\t//See if we have an exact response, and set this as our next step\r\n\t\t\tIF response[2].upper() = \"{setRespone.upper()}\"\r\n\t\t\t{\r\n\t\t\t\t//We found the response\r\n\t\t\t\tDebugLog(\"DEBUG\",\"    found exact response -({response[3]})\")\r\n\t\t\t\tmenuNextStepName = response[3]\r\n\t\t\t\tBREAK\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tIF menuNextStepName = \"NO_ACTION_FOUND\"\t\r\n\t{\r\n\t\tDebugLog(\"DEBUG\",\"Next step {menuDefaultStepName})\")\r\n\t\tRETURN menuDefaultStepName\r\n\t}\t\r\n\tDebugLog(\"DEBUG\",\"Next step {menuNextStepName})\")\r\n\tRETURN menuNextStepName\r\n}\r\n\r\n\r\nmenu.StepName = FindNextStep(global:menu.StepName.$value,global:menu.StepAction.$value,rtn)\r\nmenu.StepAction = \"\"\r\nmenu.StepPrompt = \"\"\r\nmenu.StepParams = \"\"\r\n\r\n"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "188": {
    "0": {
     "name": "ScriptName",
     "value": "{customEventsScript}"
    },
    "1": {
     "name": "ParamCount",
     "value": ""
    },
    "2": {
     "name": "ReturnVariable",
     "value": "RTN"
    },
    "3": {
     "name": "Parameters",
     "value": [
      "ONMENU"
     ]
    }
   },
   "192": {
    "0": {
     "name": "Expression",
     "value": "menu.StepName.$value.length <> \"NO_ACTION_FOUND\""
    }
   },
   "193": {
    "0": {
     "name": "ScriptName",
     "value": "{customEventsScript}"
    },
    "1": {
     "name": "ParamCount",
     "value": ""
    },
    "2": {
     "name": "ReturnVariable",
     "value": "rtn"
    },
    "3": {
     "name": "Parameters",
     "value": [
      "CustomQueueEvent",
      "{menu.StepPrompt.$value}",
      "{menu.StepParams.$value}"
     ]
    }
   },
   "194": {
    "0": {
     "name": "Variable",
     "value": "{menu.StepAction.$value}"
    }
   },
   "196": {
    "0": {
     "name": "Data",
     "value": "//Use this variable to see what happened in the history of the call - similar to press path\r\n\r\n\r\nFUNCTION DebugLog(logLevel,logLine)\r\n{\r\n\tglobal:pressPath[1+global:pressPath.count] = \"{now.datefmt(\"yyyy_MM_dd HH:mm:ss\")}\t[{logLevel.left(1)}]\t[MENU]\t{logLine}\" \r\n\tglobal:pressPath.savetodb(1)\r\n}\r\n"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   },
   "197": {
    "0": {
     "name": "CauseCode",
     "value": ""
    },
    "1": {
     "name": "CallResult",
     "value": ""
    }
   },
   "198": {
    "0": {
     "name": "Data",
     "value": "DebugLog(\"DEBUG\",\"Released call\")"
    },
    "1": {
     "name": "MaxStringSize",
     "value": "Limit2K"
    }
   }
  },
  "branches": {
   "145": [
    {
     "to": 188,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "158": [
    {
     "to": 171,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "167": [
    {
     "to": 73,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "171": [
    {
     "to": 145,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "173": [
    {
     "to": 174,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "174": [
    {
     "to": 179,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "175": [
    {
     "to": 182,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "177": [
    {
     "to": 167,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "179": [
    {
     "to": 194,
     "label": "True",
     "type": "branch",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    },
    {
     "to": 180,
     "label": "False",
     "type": "branch",
     "labelDistance": null,
     "index": 1,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "180": [
    {
     "to": 167,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "182": [
    {
     "to": 187,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    },
    {
     "to": 167,
     "label": "NEXTSCRIPT",
     "type": "custom",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    },
    {
     "to": 167,
     "label": "QUEUE",
     "type": "custom",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "187": [
    {
     "to": 192,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "188": [
    {
     "to": 173,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "192": [
    {
     "to": 174,
     "label": "True",
     "type": "branch",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    },
    {
     "to": 177,
     "label": "False",
     "type": "branch",
     "labelDistance": null,
     "index": 1,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "193": [
    {
     "to": 182,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "194": [
    {
     "to": 175,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    },
    {
     "to": 193,
     "label": "CUSTOMEVENT",
     "type": "custom",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ],
   "197": [
    {
     "to": 198,
     "label": "",
     "type": "default",
     "labelDistance": null,
     "index": 0,
     "ports": "",
     "lineType": "",
     "elbows": []
    }
   ]
  },
  "schemaVersion": "1.0.0"
 }
}